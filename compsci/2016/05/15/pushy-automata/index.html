<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width initial-scale=1" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>Pushy Automata</title>
    <meta name="description" content="A web log. Mostly about computer science-y stuff. 
">

    <link rel="stylesheet" href="/css/main.css">
    <link rel="canonical" href="https://blog.jeffsmits.net/compsci/2016/05/15/pushy-automata/">
    
    <link rel="stylesheet" type="text/css" href="/css/katex.min.css">
</head>


  <body>

    <header class="site-header">

  <div class="wrapper">

    <a class="site-title" href="/">Whatever</a>

    <nav class="site-nav">
      <a href="#" class="menu-icon">
        <svg viewBox="0 0 18 15">
          <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"/>
          <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"/>
          <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"/>
        </svg>
      </a>

      <div class="trigger">
        
          
          <a class="page-link" href="/about/">About</a>
          
        
          
        
          
        
          
        
      </div>
    </nav>

  </div>

</header>


    <div class="page-content">
      <div class="wrapper">
        <div class="post">

  <header class="post-header">
    <h1 class="post-title">Pushy Automata</h1>
    <p class="post-meta">May 15, 2016</p>
  </header>

  <article class="post-content">
    <p>Welcome back! This is my second post in a <a href="/compsci/2016/03/28/theory-of-computation/">series</a> on Automata. I decided to do another theory post first on context-free languages, and only afterwards start on a more implementation-heavy post about implementing this kind of theory in Rust for practically useful stuff. There is of course still code in this post as well :)</p>

<p>I’ll start with a quick refresher, but for more details read the <a href="/compsci/2016/04/10/finite-automata/">first post</a>.</p>

<h1 id="finite-automata-refresher">Finite Automata refresher</h1>

<p>Last time, we looked at deterministic and non-deterministic finite automata (DFAs and NFAs resp.), which can handle regular expressions (in fact, they are equivalent). These automata are finite state machines that only (1) take input and (2) return a binary accept/reject output. Finite automata <em>accept</em> when they end up in an accept state at the end of the input. You formally describe a finite automaton is by defining:</p>

<ol>
  <li>the allowable input symbols (or <em>alphabet</em> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">Σ</mi></mrow><annotation encoding="application/x-tex">\Sigma</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">Σ</span></span></span></span>),</li>
  <li>the <em>states</em> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Q</mi></mrow><annotation encoding="application/x-tex">Q</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">Q</span></span></span></span>,</li>
  <li>the <em>state transitions</em> (as a finite mapping <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi></mrow><annotation encoding="application/x-tex">\delta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal" style="margin-right:0.03785em;">δ</span></span></span></span>),</li>
  <li>the <em>start state</em> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">q_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> and</li>
  <li>the <em>final</em> or <em>accept states</em> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>F</mi></mrow><annotation encoding="application/x-tex">F</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span></span></span></span>.</li>
</ol>

<p>DFAs require every state to have one and only one transition per input symbol. NFAs can have states that don’t handle certain input symbols and states that have multiple transitions for the same input symbol. An NFA-<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi></mrow><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span> even extends the alphabet with the empty string <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi></mrow><annotation encoding="application/x-tex">\varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span>, so a transition doesn’t have to consume input. The difference between NFAs and DFAs is not in ability (NFA execution is similar to translation to DFA + execution), but NFAs are easier to define.</p>

<h1 id="pushdown-automata">Pushdown Automata</h1>

<p>The non-regular language example from the previous post was: “Words in this language start with zeroes and after the zeroes are an equal number of ones”. We can’t count an arbitrary amount of zeroes in a finite number of states, so we can’t remember how many ones we need to see at the end. Therefore, we extend our automata with a <em>stack</em>. This stack makes an automaton equivalent in power to the context-free grammar. This type of grammar is used a lot in the reference manuals of programming languages. In fact, there are many tools that allow you to write a context-free grammar and generate a parser from it!</p>

<p>The finite automaton that has a stack is called a pushdown automaton (PDA). You can think of the stack as a tray dispenser that you can <em>push</em> new trays <em>down</em> on. Let’s kick things off with an example PDA that recognises our non-regular language example:</p>

<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: Non&#45;regular language example Pages: 1 -->
<svg role="img" aria-label="Non-regular language example" width="401pt" height="79pt" viewBox="0.00 0.00 401.32 78.90">
<title>Non-regular language example</title>
<desc>digraph &quot;Non-regular language example&quot; { 
bgcolor=&quot;transparent&quot;;
rankdir=LR;
node [shape=circle, fixedsize=shape, width=0.5];
start [shape=none, label=&quot;&quot;, width=0];
q₀ [shape=doublecircle, width=0.4];
q₃ [shape=doublecircle, width=0.4];
start -&gt; q₀;
q₀ -&gt; q₁ [label=&quot;ε, ε → $&quot;];
q₁ -&gt; q₂ [label=&quot;ε&quot;];
q₂ -&gt; q₃ [label=&quot;ε, $ → ε&quot;];
q₁ -&gt; q₁ [label=&quot;0, ε → 0&quot;];
q₂ -&gt; q₂ [label=&quot;1, 0 → ε&quot;];
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 74.9)">
<title>Non&#45;regular language example</title>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
</g>
<!-- q₀ -->
<g id="node2" class="node">
<title>q₀</title>
<ellipse fill="none" stroke="black" cx="56.12" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="56.12" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="56.12" y="-13.35" font-family="Times,serif" font-size="14.00">q₀</text>
</g>
<!-- start&#45;&gt;q₀ -->
<g id="edge1" class="edge">
<title>start&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M18.23,-18.4C20.91,-18.4 23.72,-18.4 26.56,-18.4" />
<polygon fill="black" stroke="black" points="26.5,-21.9 36.5,-18.4 26.5,-14.9 26.5,-21.9" />
</g>
<!-- q₁ -->
<g id="node4" class="node">
<title>q₁</title>
<ellipse fill="none" stroke="black" cx="176.52" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="176.52" y="-13.35" font-family="Times,serif" font-size="14.00">q₁</text>
</g>
<!-- q₀&#45;&gt;q₁ -->
<g id="edge2" class="edge">
<title>q₀&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M74.34,-18.4C93.47,-18.4 124.67,-18.4 147.37,-18.4" />
<polygon fill="black" stroke="black" points="147.15,-21.9 157.15,-18.4 147.15,-14.9 147.15,-21.9" />
<text text-anchor="middle" x="116.52" y="-21.6" font-family="Times,serif" font-size="14.00">ε, ε → $</text>
</g>
<!-- q₃ -->
<g id="node3" class="node">
<title>q₃</title>
<ellipse fill="none" stroke="black" cx="374.92" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="374.92" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="374.92" y="-13.35" font-family="Times,serif" font-size="14.00">q₃</text>
</g>
<!-- q₁&#45;&gt;q₁ -->
<g id="edge5" class="edge">
<title>q₁&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M169.72,-34.69C168.08,-44.79 170.35,-54.4 176.52,-54.4 180.18,-54.4 182.47,-51.01 183.38,-46.14" />
<polygon fill="black" stroke="black" points="186.88,-46.18 183.33,-36.2 179.88,-46.22 186.88,-46.18" />
<text text-anchor="middle" x="176.52" y="-57.6" font-family="Times,serif" font-size="14.00">0, ε → 0</text>
</g>
<!-- q₂ -->
<g id="node5" class="node">
<title>q₂</title>
<ellipse fill="none" stroke="black" cx="254.52" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="254.52" y="-13.35" font-family="Times,serif" font-size="14.00">q₂</text>
</g>
<!-- q₁&#45;&gt;q₂ -->
<g id="edge3" class="edge">
<title>q₁&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M194.39,-18.4C203.44,-18.4 214.84,-18.4 225.21,-18.4" />
<polygon fill="black" stroke="black" points="225.19,-21.9 235.19,-18.4 225.19,-14.9 225.19,-21.9" />
<text text-anchor="middle" x="215.52" y="-21.6" font-family="Times,serif" font-size="14.00">ε</text>
</g>
<!-- q₂&#45;&gt;q₃ -->
<g id="edge4" class="edge">
<title>q₂&#45;&gt;q₃</title>
<path fill="none" stroke="black" d="M272.48,-18.4C291.45,-18.4 322.5,-18.4 345.25,-18.4" />
<polygon fill="black" stroke="black" points="345.09,-21.9 355.09,-18.4 345.09,-14.9 345.09,-21.9" />
<text text-anchor="middle" x="314.52" y="-21.6" font-family="Times,serif" font-size="14.00">ε, $ → ε</text>
</g>
<!-- q₂&#45;&gt;q₂ -->
<g id="edge6" class="edge">
<title>q₂&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M247.72,-34.69C246.08,-44.79 248.35,-54.4 254.52,-54.4 258.18,-54.4 260.47,-51.01 261.38,-46.14" />
<polygon fill="black" stroke="black" points="264.88,-46.18 261.33,-36.2 257.88,-46.22 264.88,-46.18" />
<text text-anchor="middle" x="254.52" y="-57.6" font-family="Times,serif" font-size="14.00">1, 0 → ε</text>
</g>
</g>
</svg>
</div>

<p>So what’s happening here? The transitions now have a lot more than than just the input symbol being consumed. After the comma is the top stack symbol that’s popped, and after the arrow is the new stack symbol to be pushed. If you look at <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>, it is taking <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>’s off the input and pushed them onto the stack. Then it takes in as many <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>’s as <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span>’s, by popping a <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn></mrow><annotation encoding="application/x-tex">0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> off the stack for every <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn></mrow><annotation encoding="application/x-tex">1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span> in the input.<br />
The outer states are only there to make sure we have a fully empty stack before we go into a final state. The <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi mathvariant="normal">$</mi></mrow><annotation encoding="application/x-tex">\$</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8056em;vertical-align:-0.0556em;"></span><span class="mord">$</span></span></span></span> is usually used as an <em>End Of Stack</em> character. You can also change the definition of the PDA to already hold 1 character on the stack at the start. This is part of the definition as you find it on <a href="https://en.wikipedia.org/wiki/Pushdown_automaton#Formal_definition">Wikipedia</a>.</p>

<h2 id="determinism">Determinism</h2>

<p>The previous PDA was non-deterministic, but we can make it deterministic. I’ve left off the stuck state, but there should be no overlapping transitions and all transitions consume either input, stack or both.</p>

<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: Non&#45;regular language example, deterministic Pages: 1 -->
<svg role="img" aria-label="Non-regular language example, deterministic" width="446pt" height="79pt" viewBox="0.00 0.00 445.57 78.90">
<title>Non-regular language example, deterministic</title>
<desc>digraph &quot;Non-regular language example, deterministic&quot; { 
bgcolor=&quot;transparent&quot;;
rankdir=LR;
node [shape=circle, fixedsize=shape, width=0.5];
start [shape=none, label=&quot;&quot;, width=0];
q₀ [shape=doublecircle, width=0.4];
q₃ [shape=doublecircle, width=0.4];
start -&gt; q₀;
q₀ -&gt; q₁ [label=&quot;0, ε → $&quot;];
q₁ -&gt; q₂ [label=&quot;1, 0 → ε&quot;];
q₂ -&gt; q₃ [label=&quot;1, $ → ε&quot;];
q₁ -&gt; q₁ [label=&quot;0, ε → 0&quot;];
q₂ -&gt; q₂ [label=&quot;1, 0 → ε&quot;];
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 74.9)">
<title>Non&#45;regular language example, deterministic</title>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
</g>
<!-- q₀ -->
<g id="node2" class="node">
<title>q₀</title>
<ellipse fill="none" stroke="black" cx="56.12" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="56.12" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="56.12" y="-13.35" font-family="Times,serif" font-size="14.00">q₀</text>
</g>
<!-- start&#45;&gt;q₀ -->
<g id="edge1" class="edge">
<title>start&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M18.23,-18.4C20.91,-18.4 23.72,-18.4 26.56,-18.4" />
<polygon fill="black" stroke="black" points="26.5,-21.9 36.5,-18.4 26.5,-14.9 26.5,-21.9" />
</g>
<!-- q₁ -->
<g id="node4" class="node">
<title>q₁</title>
<ellipse fill="none" stroke="black" cx="177.27" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="177.27" y="-13.35" font-family="Times,serif" font-size="14.00">q₁</text>
</g>
<!-- q₀&#45;&gt;q₁ -->
<g id="edge2" class="edge">
<title>q₀&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M74.45,-18.4C93.7,-18.4 125.1,-18.4 147.94,-18.4" />
<polygon fill="black" stroke="black" points="147.8,-21.9 157.8,-18.4 147.8,-14.9 147.8,-21.9" />
<text text-anchor="middle" x="116.89" y="-21.6" font-family="Times,serif" font-size="14.00">0, ε → $</text>
</g>
<!-- q₃ -->
<g id="node3" class="node">
<title>q₃</title>
<ellipse fill="none" stroke="black" cx="419.17" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="419.17" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="419.17" y="-13.35" font-family="Times,serif" font-size="14.00">q₃</text>
</g>
<!-- q₁&#45;&gt;q₁ -->
<g id="edge5" class="edge">
<title>q₁&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M167.17,-33.19C163.88,-43.82 167.25,-54.4 177.27,-54.4 183.53,-54.4 187.2,-50.27 188.26,-44.57" />
<polygon fill="black" stroke="black" points="191.76,-44.4 187.49,-34.7 184.78,-44.94 191.76,-44.4" />
<text text-anchor="middle" x="177.27" y="-57.6" font-family="Times,serif" font-size="14.00">0, ε → 0</text>
</g>
<!-- q₂ -->
<g id="node5" class="node">
<title>q₂</title>
<ellipse fill="none" stroke="black" cx="298.02" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="298.02" y="-13.35" font-family="Times,serif" font-size="14.00">q₂</text>
</g>
<!-- q₁&#45;&gt;q₂ -->
<g id="edge3" class="edge">
<title>q₁&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M195.03,-18.4C214.22,-18.4 245.95,-18.4 268.92,-18.4" />
<polygon fill="black" stroke="black" points="268.83,-21.9 278.83,-18.4 268.83,-14.9 268.83,-21.9" />
<text text-anchor="middle" x="237.64" y="-21.6" font-family="Times,serif" font-size="14.00">1, 0 → ε</text>
</g>
<!-- q₂&#45;&gt;q₃ -->
<g id="edge4" class="edge">
<title>q₂&#45;&gt;q₃</title>
<path fill="none" stroke="black" d="M315.84,-18.4C334.98,-18.4 366.56,-18.4 389.59,-18.4" />
<polygon fill="black" stroke="black" points="389.54,-21.9 399.54,-18.4 389.54,-14.9 389.54,-21.9" />
<text text-anchor="middle" x="358.39" y="-21.6" font-family="Times,serif" font-size="14.00">1, $ → ε</text>
</g>
<!-- q₂&#45;&gt;q₂ -->
<g id="edge6" class="edge">
<title>q₂&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M287.92,-33.19C284.63,-43.82 288,-54.4 298.02,-54.4 304.28,-54.4 307.95,-50.27 309.01,-44.57" />
<polygon fill="black" stroke="black" points="312.51,-44.4 308.24,-34.7 305.53,-44.94 312.51,-44.4" />
<text text-anchor="middle" x="298.02" y="-57.6" font-family="Times,serif" font-size="14.00">1, 0 → ε</text>
</g>
</g>
</svg>
</div>

<p>Now in general, we <em>cannot</em> change our PDAs to a deterministic version (deterministic PDAs are strictly less powerful). For example, take the language of even-length binary palindromes. This language can be recognised by the following non-deterministic PDA, but not by a deterministic one:</p>

<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: Even&#45;length binary palindromes Pages: 1 -->
<svg role="img" aria-label="Even-length binary palindromes" width="401pt" height="95pt" viewBox="0.00 0.00 401.32 95.40">
<title>Even-length binary palindromes</title>
<desc>digraph &quot;Even-length binary palindromes&quot; { 
bgcolor=&quot;transparent&quot;;
rankdir=LR;
node [shape=circle, fixedsize=shape, width=0.5];
start [shape=none, label=&quot;&quot;, width=0];
q₀ [shape=doublecircle, width=0.4];
q₃ [shape=doublecircle, width=0.4];
start -&gt; q₀;
q₀ -&gt; q₁ [label=&quot;ε, ε → $&quot;];
q₁ -&gt; q₂ [label=&quot;ε&quot;];
q₂ -&gt; q₃ [label=&quot;ε, $ → ε&quot;];
q₁ -&gt; q₁ [label=&quot;0, ε → 0\n1, ε → 1&quot;];
q₂ -&gt; q₂ [label=&quot;0, 0 → ε\n1, 1 → ε&quot;];
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 91.4)">
<title>Even&#45;length binary palindromes</title>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
</g>
<!-- q₀ -->
<g id="node2" class="node">
<title>q₀</title>
<ellipse fill="none" stroke="black" cx="56.12" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="56.12" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="56.12" y="-13.35" font-family="Times,serif" font-size="14.00">q₀</text>
</g>
<!-- start&#45;&gt;q₀ -->
<g id="edge1" class="edge">
<title>start&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M18.23,-18.4C20.91,-18.4 23.72,-18.4 26.56,-18.4" />
<polygon fill="black" stroke="black" points="26.5,-21.9 36.5,-18.4 26.5,-14.9 26.5,-21.9" />
</g>
<!-- q₁ -->
<g id="node4" class="node">
<title>q₁</title>
<ellipse fill="none" stroke="black" cx="176.52" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="176.52" y="-13.35" font-family="Times,serif" font-size="14.00">q₁</text>
</g>
<!-- q₀&#45;&gt;q₁ -->
<g id="edge2" class="edge">
<title>q₀&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M74.34,-18.4C93.47,-18.4 124.67,-18.4 147.37,-18.4" />
<polygon fill="black" stroke="black" points="147.15,-21.9 157.15,-18.4 147.15,-14.9 147.15,-21.9" />
<text text-anchor="middle" x="116.52" y="-21.6" font-family="Times,serif" font-size="14.00">ε, ε → $</text>
</g>
<!-- q₃ -->
<g id="node3" class="node">
<title>q₃</title>
<ellipse fill="none" stroke="black" cx="374.92" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="374.92" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="374.92" y="-13.35" font-family="Times,serif" font-size="14.00">q₃</text>
</g>
<!-- q₁&#45;&gt;q₁ -->
<g id="edge5" class="edge">
<title>q₁&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M169.72,-34.69C168.08,-44.79 170.35,-54.4 176.52,-54.4 180.18,-54.4 182.47,-51.01 183.38,-46.14" />
<polygon fill="black" stroke="black" points="186.88,-46.18 183.33,-36.2 179.88,-46.22 186.88,-46.18" />
<text text-anchor="middle" x="176.52" y="-74.1" font-family="Times,serif" font-size="14.00">0, ε → 0</text>
<text text-anchor="middle" x="176.52" y="-57.6" font-family="Times,serif" font-size="14.00">1, ε → 1</text>
</g>
<!-- q₂ -->
<g id="node5" class="node">
<title>q₂</title>
<ellipse fill="none" stroke="black" cx="254.52" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="254.52" y="-13.35" font-family="Times,serif" font-size="14.00">q₂</text>
</g>
<!-- q₁&#45;&gt;q₂ -->
<g id="edge3" class="edge">
<title>q₁&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M194.39,-18.4C203.44,-18.4 214.84,-18.4 225.21,-18.4" />
<polygon fill="black" stroke="black" points="225.19,-21.9 235.19,-18.4 225.19,-14.9 225.19,-21.9" />
<text text-anchor="middle" x="215.52" y="-21.6" font-family="Times,serif" font-size="14.00">ε</text>
</g>
<!-- q₂&#45;&gt;q₃ -->
<g id="edge4" class="edge">
<title>q₂&#45;&gt;q₃</title>
<path fill="none" stroke="black" d="M272.48,-18.4C291.45,-18.4 322.5,-18.4 345.25,-18.4" />
<polygon fill="black" stroke="black" points="345.09,-21.9 355.09,-18.4 345.09,-14.9 345.09,-21.9" />
<text text-anchor="middle" x="314.52" y="-21.6" font-family="Times,serif" font-size="14.00">ε, $ → ε</text>
</g>
<!-- q₂&#45;&gt;q₂ -->
<g id="edge6" class="edge">
<title>q₂&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M247.72,-34.69C246.08,-44.79 248.35,-54.4 254.52,-54.4 258.18,-54.4 260.47,-51.01 261.38,-46.14" />
<polygon fill="black" stroke="black" points="264.88,-46.18 261.33,-36.2 257.88,-46.22 264.88,-46.18" />
<text text-anchor="middle" x="254.52" y="-74.1" font-family="Times,serif" font-size="14.00">0, 0 → ε</text>
<text text-anchor="middle" x="254.52" y="-57.6" font-family="Times,serif" font-size="14.00">1, 1 → ε</text>
</g>
</g>
</svg>
</div>

<p>If you think about it, it makes sense that a non-deterministic PDA is more powerful than a deterministic PDA. With the NFAs in the previous post we had just a finite amount of states we could be in while executing, and you can model that with (an exponential amount of) states in a DFA. But for a PDA, it isn’t just the state that matters, but the stack as well. Since the stack isn’t finite, we can’t just model it in more states.</p>

<h2 id="code">Code</h2>

<p>These PDAs are a bit annoying to write as is. Epsilons for the input character mean that we’re not advancing the input. We could write a direct encoding of the formal definition, but then we need to resolve epsilons at runtime. The execution would become pull-based, asking for input and the top of the stack when we need it. Somehow that feels wrong to me.<br />
So instead we’re going to adapt our definition of PDAs, so that we can write code that’s still driven by the input. Let’s see if we can eliminate epsilons in the input position. There are five cases:</p>

<ul>
  <li>Add something to the stack at the start
    <ul>
      <li>Example: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>0</mn></msub><mo>→</mo><msub><mi>q</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">q_0 \rightarrow q_1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
      <li>Fix: Allow stack to start with a static bunch of symbols on it</li>
    </ul>
  </li>
  <li>Add multiple things to the stack on a certain input
    <ul>
      <li>Fix: Allow pushing multiple things on the stack</li>
    </ul>
  </li>
  <li>Express some non-determinism easily by doing nothing with the stack or the input
    <ul>
      <li>Example: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>→</mo><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">q_1 \rightarrow q_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
      <li>Fix: This is the tradition NFA epsilon move, we can do a local powerset construction for this</li>
    </ul>
  </li>
  <li>Remove multiple things from the stack on a certain input
    <ul>
      <li>Fix: Allow popping multiple things off the stack</li>
    </ul>
  </li>
  <li>Remove stuff from the stack at the end of the input
    <ul>
      <li>Example: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>q</mi><mn>1</mn></msub><mo>→</mo><msub><mi>q</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">q_1 \rightarrow q_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">1</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.1944em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">q</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3011em;"><span style="top:-2.55em;margin-left:-0.0359em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></li>
      <li>Fix? Not sure if there is one, so we’ll just have to deal with this one</li>
    </ul>
  </li>
</ul>

<p>With the above fixes, we can get a PDA that will always either advance one step in the input, or at the end of the input advance on the stack. These fixes can be expressed in the original definition, so it still has the same power. Here’s the new version of the PDA:</p>

<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: Even&#45;length binary palindromes, v2 Pages: 1 -->
<svg role="img" aria-label="Even-length binary palindromes, v2" width="451pt" height="95pt" viewBox="0.00 0.00 450.57 95.40">
<title>Even-length binary palindromes, v2</title>
<desc>digraph &quot;Even-length binary palindromes, v2&quot; { 
bgcolor=&quot;transparent&quot;;
rankdir=LR;
node [shape=circle, fixedsize=shape, width=0.5];
start [shape=none, label=&quot;&quot;, width=0];
q₀ [shape=doublecircle, width=0.4, label=&quot;q₀′&quot;];
q₃ [shape=doublecircle, width=0.4, label=&quot;q₃′&quot;];
q₁ [label=&quot;q₁′&quot;];
q₂ [label=&quot;q₂′&quot;];
start -&gt; q₀ [label=&quot;$&quot;];
q₀ -&gt; q₁ [label=&quot;0, ε → 0\n1, ε → 1&quot;];
q₁ -&gt; q₂ [label=&quot;0, 0 → ε\n1, 1 → ε&quot;];
q₂ -&gt; q₃ [label=&quot;ε, $ → ε&quot;];
q₁ -&gt; q₁ [label=&quot;0, ε → 0\n1, ε → 1&quot;];
q₂ -&gt; q₂ [label=&quot;0, 0 → ε\n1, 1 → ε&quot;];
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 91.4)">
<title>Even&#45;length binary palindromes, v2</title>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
</g>
<!-- q₀ -->
<g id="node2" class="node">
<title>q₀</title>
<ellipse fill="none" stroke="black" cx="61.87" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="61.87" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="61.87" y="-13.35" font-family="Times,serif" font-size="14.00">q₀′</text>
</g>
<!-- start&#45;&gt;q₀ -->
<g id="edge1" class="edge">
<title>start&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M18.12,-18.4C22.65,-18.4 27.64,-18.4 32.58,-18.4" />
<polygon fill="black" stroke="black" points="32.21,-21.9 42.21,-18.4 32.21,-14.9 32.21,-21.9" />
<text text-anchor="middle" x="22.1" y="-21.6" font-family="Times,serif" font-size="14.00">$</text>
</g>
<!-- q₁ -->
<g id="node4" class="node">
<title>q₁</title>
<ellipse fill="none" stroke="black" cx="183.02" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="183.02" y="-13.35" font-family="Times,serif" font-size="14.00">q₁′</text>
</g>
<!-- q₀&#45;&gt;q₁ -->
<g id="edge2" class="edge">
<title>q₀&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M80.2,-18.4C99.45,-18.4 130.85,-18.4 153.69,-18.4" />
<polygon fill="black" stroke="black" points="153.55,-21.9 163.55,-18.4 153.55,-14.9 153.55,-21.9" />
<text text-anchor="middle" x="122.64" y="-38.1" font-family="Times,serif" font-size="14.00">0, ε → 0</text>
<text text-anchor="middle" x="122.64" y="-21.6" font-family="Times,serif" font-size="14.00">1, ε → 1</text>
</g>
<!-- q₃ -->
<g id="node3" class="node">
<title>q₃</title>
<ellipse fill="none" stroke="black" cx="424.17" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="424.17" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="424.17" y="-13.35" font-family="Times,serif" font-size="14.00">q₃′</text>
</g>
<!-- q₁&#45;&gt;q₁ -->
<g id="edge5" class="edge">
<title>q₁&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M172.92,-33.19C169.63,-43.82 173,-54.4 183.02,-54.4 189.28,-54.4 192.95,-50.27 194.01,-44.57" />
<polygon fill="black" stroke="black" points="197.51,-44.4 193.24,-34.7 190.53,-44.94 197.51,-44.4" />
<text text-anchor="middle" x="183.02" y="-74.1" font-family="Times,serif" font-size="14.00">0, ε → 0</text>
<text text-anchor="middle" x="183.02" y="-57.6" font-family="Times,serif" font-size="14.00">1, ε → 1</text>
</g>
<!-- q₂ -->
<g id="node5" class="node">
<title>q₂</title>
<ellipse fill="none" stroke="black" cx="303.77" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="303.77" y="-13.35" font-family="Times,serif" font-size="14.00">q₂′</text>
</g>
<!-- q₁&#45;&gt;q₂ -->
<g id="edge3" class="edge">
<title>q₁&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M200.78,-18.4C219.97,-18.4 251.7,-18.4 274.67,-18.4" />
<polygon fill="black" stroke="black" points="274.58,-21.9 284.58,-18.4 274.58,-14.9 274.58,-21.9" />
<text text-anchor="middle" x="243.39" y="-38.1" font-family="Times,serif" font-size="14.00">0, 0 → ε</text>
<text text-anchor="middle" x="243.39" y="-21.6" font-family="Times,serif" font-size="14.00">1, 1 → ε</text>
</g>
<!-- q₂&#45;&gt;q₃ -->
<g id="edge4" class="edge">
<title>q₂&#45;&gt;q₃</title>
<path fill="none" stroke="black" d="M321.73,-18.4C340.7,-18.4 371.75,-18.4 394.5,-18.4" />
<polygon fill="black" stroke="black" points="394.34,-21.9 404.34,-18.4 394.34,-14.9 394.34,-21.9" />
<text text-anchor="middle" x="363.77" y="-21.6" font-family="Times,serif" font-size="14.00">ε, $ → ε</text>
</g>
<!-- q₂&#45;&gt;q₂ -->
<g id="edge6" class="edge">
<title>q₂&#45;&gt;q₂</title>
<path fill="none" stroke="black" d="M293.73,-33.19C290.46,-43.82 293.81,-54.4 303.77,-54.4 310,-54.4 313.64,-50.27 314.7,-44.57" />
<polygon fill="black" stroke="black" points="318.19,-44.4 313.93,-34.7 311.21,-44.94 318.19,-44.4" />
<text text-anchor="middle" x="303.77" y="-74.1" font-family="Times,serif" font-size="14.00">0, 0 → ε</text>
<text text-anchor="middle" x="303.77" y="-57.6" font-family="Times,serif" font-size="14.00">1, 1 → ε</text>
</g>
</g>
</svg>
</div>

<p>So with that, we can go to the code. I apologise for the messier transition functions. Those don’t correspond to the diagram as clearly. In retrospect this approach to the transition functions would have also worked for the other PDA, although it would be slightly less efficient (I think).</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">type</span> <span class="n">State</span> <span class="o">=</span> <span class="nb">u8</span><span class="p">;</span>
<span class="k">type</span> <span class="n">InputSymbol</span> <span class="o">=</span> <span class="nb">u8</span><span class="p">;</span>
<span class="k">type</span> <span class="n">StackSymbol</span> <span class="o">=</span> <span class="nb">u8</span><span class="p">;</span>
<span class="k">type</span> <span class="n">Stack</span> <span class="o">=</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="n">StackSymbol</span><span class="o">&gt;</span><span class="p">;</span>

<span class="k">const</span> <span class="n">EOS</span><span class="p">:</span> <span class="n">StackSymbol</span> <span class="o">=</span> <span class="mi">2</span><span class="p">;</span> <span class="c">// End of Stack symbol</span>

<span class="k">fn</span> <span class="nf">transition</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="n">input</span><span class="p">:</span> <span class="n">InputSymbol</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">)</span>
    <span class="k">-&gt;</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="p">(</span><span class="n">State</span><span class="p">,</span> <span class="n">Stack</span><span class="p">)</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">match</span> <span class="n">state</span> <span class="p">{</span>
    <span class="mi">0</span> <span class="k">=&gt;</span> <span class="p">{</span>
      <span class="k">let</span> <span class="k">mut</span> <span class="n">new_stack</span> <span class="o">=</span> <span class="n">stack</span><span class="nf">.clone</span><span class="p">();</span>
      <span class="n">new_stack</span><span class="nf">.push</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
      <span class="nd">vec!</span><span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">new_stack</span><span class="p">)</span> <span class="p">]</span>
    <span class="p">}</span>
    <span class="mi">1</span> <span class="k">=&gt;</span> <span class="p">{</span>
      <span class="k">let</span> <span class="k">mut</span> <span class="n">new_stack1</span> <span class="o">=</span> <span class="n">stack</span><span class="nf">.clone</span><span class="p">();</span>
      <span class="n">new_stack1</span><span class="nf">.push</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
      <span class="k">match</span> <span class="n">stack</span><span class="nf">.last</span><span class="p">()</span><span class="nf">.map</span><span class="p">(|</span><span class="o">&amp;</span><span class="n">top</span><span class="p">|</span> <span class="n">top</span> <span class="o">==</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
        <span class="nf">Some</span><span class="p">(</span><span class="k">true</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="p">{</span>
          <span class="k">let</span> <span class="k">mut</span> <span class="n">new_stack2</span> <span class="o">=</span> <span class="n">stack</span><span class="nf">.clone</span><span class="p">();</span>
          <span class="n">new_stack2</span><span class="nf">.pop</span><span class="p">();</span>
          <span class="nd">vec!</span><span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">new_stack1</span><span class="p">),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">new_stack2</span><span class="p">)</span> <span class="p">]</span>
        <span class="p">}</span>
        <span class="nf">Some</span><span class="p">(</span><span class="k">false</span><span class="p">)</span> <span class="k">=&gt;</span> <span class="p">{</span>
          <span class="nd">vec!</span><span class="p">[</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">new_stack1</span><span class="p">)</span> <span class="p">]</span>
        <span class="p">}</span>
        <span class="nb">None</span> <span class="k">=&gt;</span> <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="mi">2</span> <span class="k">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="n">stack</span><span class="nf">.last</span><span class="p">()</span><span class="nf">.map_or</span><span class="p">(</span><span class="k">false</span><span class="p">,</span> <span class="p">|</span><span class="o">&amp;</span><span class="n">top</span><span class="p">|</span> <span class="n">top</span> <span class="o">==</span> <span class="n">input</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">new_stack</span> <span class="o">=</span> <span class="n">stack</span><span class="nf">.clone</span><span class="p">();</span>
        <span class="n">new_stack</span><span class="nf">.pop</span><span class="p">();</span>
        <span class="nd">vec!</span><span class="p">[</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">new_stack</span><span class="p">)</span> <span class="p">]</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="mi">_</span> <span class="k">=&gt;</span> <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">fn</span> <span class="nf">epsilon_transition</span><span class="p">(</span><span class="n">state</span><span class="p">:</span> <span class="n">State</span><span class="p">,</span> <span class="n">stack</span><span class="p">:</span> <span class="n">Stack</span><span class="p">)</span> <span class="k">-&gt;</span> <span class="nb">Vec</span><span class="o">&lt;</span><span class="p">(</span><span class="n">State</span><span class="p">,</span> <span class="n">Stack</span><span class="p">)</span><span class="o">&gt;</span> <span class="p">{</span>
  <span class="k">match</span> <span class="n">state</span> <span class="p">{</span>
    <span class="mi">2</span> <span class="k">=&gt;</span> <span class="p">{</span>
      <span class="k">if</span> <span class="n">stack</span><span class="nf">.last</span><span class="p">()</span><span class="nf">.map_or</span><span class="p">(</span><span class="k">false</span><span class="p">,</span> <span class="p">|</span><span class="o">&amp;</span><span class="n">top</span><span class="p">|</span> <span class="n">top</span> <span class="o">==</span> <span class="n">EOS</span><span class="p">)</span> <span class="p">{</span>
        <span class="k">let</span> <span class="k">mut</span> <span class="n">new_stack</span> <span class="o">=</span> <span class="n">stack</span><span class="nf">.clone</span><span class="p">();</span>
        <span class="n">new_stack</span><span class="nf">.pop</span><span class="p">();</span>
        <span class="nd">vec!</span><span class="p">[</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">new_stack</span><span class="p">)</span> <span class="p">]</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">()</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="mi">_</span> <span class="k">=&gt;</span> <span class="nn">Vec</span><span class="p">::</span><span class="nf">new</span><span class="p">()</span>
  <span class="p">}</span>
<span class="p">}</span>

<span class="k">const</span> <span class="n">FINALS</span><span class="p">:</span> <span class="p">[</span><span class="n">State</span><span class="p">;</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">];</span>

<span class="k">const</span> <span class="n">INPUT</span><span class="p">:</span> <span class="p">[</span><span class="n">InputSymbol</span><span class="p">;</span> <span class="mi">16</span><span class="p">]</span> <span class="o">=</span>
  <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">];</span>

<span class="k">fn</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
  <span class="k">let</span> <span class="k">mut</span> <span class="n">pda_states</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[(</span><span class="mi">0</span><span class="p">,</span><span class="nd">vec!</span><span class="p">[</span><span class="n">EOS</span><span class="p">])];</span>
  <span class="k">for</span> <span class="o">&amp;</span><span class="n">input</span> <span class="n">in</span> <span class="n">INPUT</span><span class="nf">.iter</span><span class="p">()</span> <span class="p">{</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"{:?}"</span><span class="p">,</span> <span class="n">pda_states</span><span class="p">);</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">new_pda_states</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span> <span class="n">in</span> <span class="n">pda_states</span> <span class="p">{</span>
      <span class="n">new_pda_states</span><span class="nf">.append</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="nf">transition</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">input</span><span class="p">,</span> <span class="n">stack</span><span class="p">));</span>
    <span class="p">}</span>
    <span class="n">pda_states</span> <span class="o">=</span> <span class="n">new_pda_states</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="k">while</span> <span class="o">!</span><span class="n">pda_states</span><span class="nf">.is_empty</span><span class="p">()</span> <span class="p">{</span>
    <span class="nd">println!</span><span class="p">(</span><span class="s">"{:?}"</span><span class="p">,</span> <span class="n">pda_states</span><span class="p">);</span>
    <span class="k">let</span> <span class="k">mut</span> <span class="n">new_pda_states</span> <span class="o">=</span> <span class="nd">vec!</span><span class="p">[];</span>
    <span class="k">for</span> <span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">stack</span><span class="p">)</span> <span class="n">in</span> <span class="n">pda_states</span> <span class="p">{</span>
      <span class="k">if</span> <span class="n">FINALS</span><span class="nf">.iter</span><span class="p">()</span><span class="nf">.any</span><span class="p">(|</span><span class="o">&amp;</span><span class="n">x</span><span class="p">|</span> <span class="n">x</span> <span class="o">==</span> <span class="n">state</span><span class="p">)</span> <span class="p">{</span>
        <span class="nd">println!</span><span class="p">(</span><span class="s">"The input is accepted"</span><span class="p">);</span>
        <span class="k">return</span><span class="p">;</span>
      <span class="p">}</span>
      <span class="k">else</span> <span class="p">{</span>
        <span class="n">new_pda_states</span><span class="nf">.append</span><span class="p">(</span><span class="o">&amp;</span><span class="k">mut</span> <span class="nf">epsilon_transition</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">stack</span><span class="p">));</span>
      <span class="p">}</span>
    <span class="p">}</span>
    <span class="n">pda_states</span> <span class="o">=</span> <span class="n">new_pda_states</span><span class="p">;</span>
  <span class="p">}</span>
  <span class="nd">println!</span><span class="p">(</span><span class="s">"The input is not accepted"</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div></div>

<p>I left in extra prints to observe the behaviour of the PDA:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">3</span><span class="p">,</span> <span class="p">[])]</span>
<span class="n">The</span> <span class="n">input</span> <span class="n">is</span> <span class="n">accepted</span>
</code></pre></div></div>

<p>Something to note is that the amount of <code class="language-plaintext highlighter-rouge">(state, stack)</code> tuples peaks at 3 and is mostly 2. That’s not so bad. But in general you can have input strings with much worse behaviour! (<a href="https://github.com/Apanatshka/blog/tree/jekyll/_includes/compsci/2016/05/15/pushy-automata/binary_palindrome/">Try</a> a long string with only zeroes for example).</p>

<h1 id="context-free-grammars">Context-free grammars</h1>

<p>A context-free grammar (CFG) has consists of rules which are sometimes called production rules or substitution rules. Those names are basically two ways to look at the grammar: as a way to produce ‘sentences’ of the language that the grammar describes, or to reduce input to check if it’s part of the language.<br />
These rules are written with terminals (symbols from the alphabet), and sorts (or grammar variables or non-terminals). A sort is defined by one or more rules. Depending on the grammar formalism, you may see <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>←</mo></mrow><annotation encoding="application/x-tex">\leftarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">←</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>→</mo></mrow><annotation encoding="application/x-tex">\rightarrow</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">→</span></span></span></span>, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo></mrow><annotation encoding="application/x-tex">=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span></span></span></span> or <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>:</mo><mo>:</mo><mo>=</mo></mrow><annotation encoding="application/x-tex">::=</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mrel">::=</span></span></span></span> between the sort and the body of the rule. Let’s look at an example:</p>

<table>
  <tbody>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>0</mn><mi>S</mi><mn>0</mn></mrow><annotation encoding="application/x-tex"> S = 0 S 0 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">0</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-0)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-0)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-0)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mn>1</mn><mi>S</mi><mn>1</mn></mrow><annotation encoding="application/x-tex"> S = 1 S 1 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">1</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">1</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-1)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-1)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-1)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi><mo>=</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex"> S = \varepsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-</mtext><mi>ε</mi><mtext>)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-}\varepsilon\text{)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-</span></span><span class="mord mathnormal">ε</span><span class="mord text"><span class="mord">)</span></span></span></span></span></td>
    </tr>
  </tbody>
</table>

<p>This CFG describes the even-length binary palindromes that our last PDA also described. It has a single sort <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>, the <em>start sort</em> of the CFG. The zero and one are terminals, symbols from the alphabet. The epsilon is still the empty string. I’ve labelled the rules so I can refer to them later.</p>

<p>To recognise a string, we start with the input and try to reduce part of it to a sort according to one of the rules. We keep substituting until we having only a single start sort left. This is called a <em>derivation</em>. For example:</p>

<table>
  <tbody>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0010101111010100</mn></mrow><annotation encoding="application/x-tex"> 0010101111010100            </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0010101111010100</span></span></span></span></td>
      <td> </td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>00101011</mn><mi>ε</mi><mn>11010100</mn></mrow><annotation encoding="application/x-tex"> 00101011\varepsilon11010100 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">00101011</span><span class="mord mathnormal">ε</span><span class="mord">11010100</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(</mtext><mi>ε</mi><mtext> insertion)</mtext></mrow><annotation encoding="application/x-tex"> \text{(}\varepsilon\text{ insertion)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(</span></span><span class="mord mathnormal">ε</span><span class="mord text"><span class="mord"> insertion)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>00101011</mn><mi>S</mi><mn>11010100</mn></mrow><annotation encoding="application/x-tex"> 00101011S11010100           </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">00101011</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">11010100</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-</mtext><mi>ε</mi><mtext>)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-}\varepsilon\text{)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-</span></span><span class="mord mathnormal">ε</span><span class="mord text"><span class="mord">)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0010101</mn><mi>S</mi><mn>1010100</mn></mrow><annotation encoding="application/x-tex"> 0010101S1010100             </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0010101</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">1010100</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-1)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-1)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-1)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>001010</mn><mi>S</mi><mn>010100</mn></mrow><annotation encoding="application/x-tex"> 001010S010100               </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">001010</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">010100</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-1)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-1)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-1)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>00101</mn><mi>S</mi><mn>10100</mn></mrow><annotation encoding="application/x-tex"> 00101S10100                 </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">00101</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">10100</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-0)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-0)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-0)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0010</mn><mi>S</mi><mn>0100</mn></mrow><annotation encoding="application/x-tex"> 0010S0100                   </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0010</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">0100</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-1)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-1)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-1)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>001</mn><mi>S</mi><mn>100</mn></mrow><annotation encoding="application/x-tex"> 001S100                     </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">001</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">100</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-0)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-0)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-0)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>00</mn><mi>S</mi><mn>00</mn></mrow><annotation encoding="application/x-tex"> 00S00                       </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">00</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">00</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-1)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-1)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-1)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mi>S</mi><mn>0</mn></mrow><annotation encoding="application/x-tex"> 0S0                         </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">0</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-0)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-0)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-0)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex"> S                           </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Rule-0)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Rule-0)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Rule-0)</span></span></span></span></span></td>
    </tr>
  </tbody>
</table>

<p>Of course the other way around also works, start with the start sort and expand sorts non-deterministically to end up with the string to recognise.</p>

<!-- ## Code

Let's start with a bit of code to define context-free grammars in Rust:

```rust
use std::collections::HashMap;

// Sort -> set of rule alternatives
type Grammar = HashMap<Variable, Vec<RuleBody>>;
type RuleBody = Vec<RulePart>;

#[derive(Hash, Eq, PartialEq, Debug, Copy, Clone)]
enum RulePart {
  Lit(&'static str),
  Var(Variable),
  Epsilon,
}


#[derive(Hash, Eq, PartialEq, Debug, Copy, Clone)]
enum Variable {
  S,
}

fn main() {
  let mut binary_palindrome : Grammar = HashMap::new();
  
  let zero : RulePart = RulePart::Lit("0");
  let one : RulePart = RulePart::Lit("1");
  let s : RulePart = RulePart::Var(Variable::S);
  
  binary_palindrome.insert(Variable::S, vec![
    vec![ zero, s, zero],
  	vec![ one, s, one ],
  	vec![ RulePart::Epsilon ],
  ]);
  
  for (&sort, rules) in binary_palindrome.iter() {
    println!("{:?} -> {:?}", sort, rules);
  }
}

```

Output:

```
S -> [[Lit("0"), Var(S), Lit("0")], [Lit("1"), Var(S), Lit("1")], [Epsilon]]
```

If you're wondering why I didn't write the code for the derivation of the binary string as shown earlier, that's because it requires 'angelic non-determinism'. That's an oracle that tells you which rule to pick when there are multiple. Those are pretty hard to come by ;) -->

<h2 id="translation-to-pda">Translation to PDA</h2>

<p>Now CFGs are equally powerful as the PDA. That means that similar to regular expressions and NFAs/DFAs, we can translate from one to the other. Let’s do the grammar to automaton, since you’re more likely to write a grammar that you want to execute than the other way around. The idea is that you have a PDA with an EOS symbol and the start sort. Then you get to the ‘central’ state in the PDA. This state replaces the topmost sort on the stack with the <em>reversed</em> body of one of it’s rules (non-deterministically of course). If the topmost thing on the stack is a terminal instead, it will match the input against the terminal and drop both. Because the rule body was pushed on the stack in reverse that works out. When the EOS symbol is found and the input is found we go to the accept state.</p>

<p>Let’s look at the PDA for the binary palindrome grammar:</p>

<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: Even&#45;length binary palindromes, translated from the grammar Pages: 1 -->
<svg role="img" aria-label="Even-length binary palindromes, translated from the grammar" width="277pt" height="145pt" viewBox="0.00 0.00 277.27 144.90">
<title>Even-length binary palindromes, translated from the grammar</title>
<desc>digraph &quot;Even-length binary palindromes, translated from the grammar&quot; { 
bgcolor=&quot;transparent&quot;;
rankdir=LR;
node [shape=circle, fixedsize=shape, width=0.5];
start [shape=none, label=&quot;&quot;, width=0];
q₁ [shape=doublecircle, width=0.4];
start -&gt; q₀ [label=&quot;$ S&quot;];
q₀ -&gt; q₁ [label=&quot;ε, $ → ε\nε, $ S → ε&quot;];
q₀ -&gt; q₀ [label=&quot;ε, S → 0 S 0\nε, S → 1 S 1\nε, S → ε\n0, 0 →ε\n1, 1 → ε&quot;];
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 140.9)">
<title>Even&#45;length binary palindromes, translated from the grammar</title>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
</g>
<!-- q₀ -->
<g id="node3" class="node">
<title>q₀</title>
<ellipse fill="none" stroke="black" cx="95.97" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="95.97" y="-13.35" font-family="Times,serif" font-size="14.00">q₀</text>
</g>
<!-- start&#45;&gt;q₀ -->
<g id="edge1" class="edge">
<title>start&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M18.01,-18.4C31.64,-18.4 50.94,-18.4 66.8,-18.4" />
<polygon fill="black" stroke="black" points="66.6,-21.9 76.6,-18.4 66.6,-14.9 66.6,-21.9" />
<text text-anchor="middle" x="27.72" y="-21.6" font-family="Times,serif" font-size="14.00">$ S</text>
</g>
<!-- q₁ -->
<g id="node2" class="node">
<title>q₁</title>
<ellipse fill="none" stroke="black" cx="250.87" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="250.87" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="250.87" y="-13.35" font-family="Times,serif" font-size="14.00">q₁</text>
</g>
<!-- q₀&#45;&gt;q₁ -->
<g id="edge2" class="edge">
<title>q₀&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M113.92,-18.4C139.98,-18.4 190.18,-18.4 221.75,-18.4" />
<polygon fill="black" stroke="black" points="221.33,-21.9 231.33,-18.4 221.33,-14.9 221.33,-21.9" />
<text text-anchor="middle" x="184.85" y="-38.1" font-family="Times,serif" font-size="14.00">ε, $ → ε</text>
<text text-anchor="middle" x="184.85" y="-21.6" font-family="Times,serif" font-size="14.00">ε, $ S → ε</text>
</g>
<!-- q₀&#45;&gt;q₀ -->
<g id="edge3" class="edge">
<title>q₀&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M84.83,-32.44C80.66,-43.31 84.37,-54.4 95.97,-54.4 103.4,-54.4 107.59,-49.85 108.55,-43.72" />
<polygon fill="black" stroke="black" points="112.04,-43.42 107.31,-33.94 105.1,-44.31 112.04,-43.42" />
<text text-anchor="middle" x="95.97" y="-123.6" font-family="Times,serif" font-size="14.00">ε, S → 0 S 0</text>
<text text-anchor="middle" x="95.97" y="-107.1" font-family="Times,serif" font-size="14.00">ε, S → 1 S 1</text>
<text text-anchor="middle" x="95.97" y="-90.6" font-family="Times,serif" font-size="14.00">ε, S → ε</text>
<text text-anchor="middle" x="95.97" y="-74.1" font-family="Times,serif" font-size="14.00">0, 0 →ε</text>
<text text-anchor="middle" x="95.97" y="-57.6" font-family="Times,serif" font-size="14.00">1, 1 → ε</text>
</g>
</g>
</svg>
</div>

<p>I went for the PDA which starts with an initialised stack and can manipulate multiple things on (the top of) the stack at once. That gives a more compact PDA, and is also closer to an implementable state. Sadly this example doesn’t visibly show that the bodies of the rules are reversed, because all rules in this grammar are symmetrical.</p>

<p>It’s interesting to see that this PDA is actually smaller in states than our hand-written one. But this one does have some more overhead because it’s pushing a lot of stuff on the stack including sorts. Let’s see if we can reduce that overhead a little by at least making the transitions that don’t consume any input into transitions that do. For that we need to merge a rule like <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mn>0</mn><mi>S</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">\varepsilon, S \rightarrow 0 S 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ε</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">0</span></span></span></span> with other rules that will come afterwards which do consume input. That’s <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>→</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">0, 0 \rightarrow \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span> in this case. So combining the two rules gets us <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mn>0</mn><mi>S</mi></mrow><annotation encoding="application/x-tex">0, S \rightarrow 0 S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>, by adding the input symbol consumption and resolving the stack pop. We can do the same with the other transition that takes no input. The last rule to resolve is <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">\epsilon, S \rightarrow \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϵ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span>. This one can be merged with <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ϵ</mi><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mn>0</mn><mi>S</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">\epsilon, S \rightarrow 0 S 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ϵ</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">0</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>→</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">0, 0 \rightarrow \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span> to form <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">0, S \rightarrow 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span> and with the other two transitions to form <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">1, S \rightarrow 1</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span>.</p>

<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: Even&#45;length binary palindromes, translated from the grammar Pages: 1 -->
<svg role="img" aria-label="Even-length binary palindromes, translated from the grammar" width="294pt" height="161pt" viewBox="0.00 0.00 293.77 161.40">
<title>Even-length binary palindromes, translated from the grammar</title>
<desc>digraph &quot;Even-length binary palindromes, translated from the grammar&quot; { 
bgcolor=&quot;transparent&quot;;
rankdir=LR;
node [shape=circle, fixedsize=shape, width=0.5];
start [shape=none, label=&quot;&quot;, width=0];
q₁ [shape=doublecircle, width=0.4];
start -&gt; q₀ [label=&quot;$ S&quot;];
q₀ -&gt; q₁ [label=&quot;ε, $ → ε\nε, $ S → ε&quot;];
q₀ -&gt; q₀ [label=&quot;0, S → 0 S\n1, S → 1 S\n0, S → 0\n1, S → 1\n0, 0 →ε\n1, 1 → ε&quot;];
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 157.4)">
<title>Even&#45;length binary palindromes, translated from the grammar</title>
<!-- start -->
<g id="node1" class="node">
<title>start</title>
</g>
<!-- q₀ -->
<g id="node3" class="node">
<title>q₀</title>
<ellipse fill="none" stroke="black" cx="104.22" cy="-18.4" rx="18" ry="18" />
<text text-anchor="middle" x="104.22" y="-13.35" font-family="Times,serif" font-size="14.00">q₀</text>
</g>
<!-- start&#45;&gt;q₀ -->
<g id="edge1" class="edge">
<title>start&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M18.11,-18.4C33.68,-18.4 56.81,-18.4 75.03,-18.4" />
<polygon fill="black" stroke="black" points="74.92,-21.9 84.92,-18.4 74.92,-14.9 74.92,-21.9" />
<text text-anchor="middle" x="27.72" y="-21.6" font-family="Times,serif" font-size="14.00">$ S</text>
</g>
<!-- q₁ -->
<g id="node2" class="node">
<title>q₁</title>
<ellipse fill="none" stroke="black" cx="267.37" cy="-18.4" rx="14.4" ry="14.4" />
<ellipse fill="none" stroke="black" cx="267.37" cy="-18.4" rx="18.4" ry="18.4" />
<text text-anchor="middle" x="267.37" y="-13.35" font-family="Times,serif" font-size="14.00">q₁</text>
</g>
<!-- q₀&#45;&gt;q₁ -->
<g id="edge2" class="edge">
<title>q₀&#45;&gt;q₁</title>
<path fill="none" stroke="black" d="M122.16,-18.4C149.65,-18.4 204.28,-18.4 237.85,-18.4" />
<polygon fill="black" stroke="black" points="237.66,-21.9 247.66,-18.4 237.66,-14.9 237.66,-21.9" />
<text text-anchor="middle" x="201.35" y="-38.1" font-family="Times,serif" font-size="14.00">ε, $ → ε</text>
<text text-anchor="middle" x="201.35" y="-21.6" font-family="Times,serif" font-size="14.00">ε, $ S → ε</text>
</g>
<!-- q₀&#45;&gt;q₀ -->
<g id="edge3" class="edge">
<title>q₀&#45;&gt;q₀</title>
<path fill="none" stroke="black" d="M92.24,-31.32C86.78,-42.53 90.77,-54.4 104.22,-54.4 113.25,-54.4 118.02,-49.04 118.52,-42.13" />
<polygon fill="black" stroke="black" points="122.04,-41.84 116.51,-32.8 115.19,-43.31 122.04,-41.84" />
<text text-anchor="middle" x="104.22" y="-140.1" font-family="Times,serif" font-size="14.00">0, S → 0 S</text>
<text text-anchor="middle" x="104.22" y="-123.6" font-family="Times,serif" font-size="14.00">1, S → 1 S</text>
<text text-anchor="middle" x="104.22" y="-107.1" font-family="Times,serif" font-size="14.00">0, S → 0</text>
<text text-anchor="middle" x="104.22" y="-90.6" font-family="Times,serif" font-size="14.00">1, S → 1</text>
<text text-anchor="middle" x="104.22" y="-74.1" font-family="Times,serif" font-size="14.00">0, 0 →ε</text>
<text text-anchor="middle" x="104.22" y="-57.6" font-family="Times,serif" font-size="14.00">1, 1 → ε</text>
</g>
</g>
</svg>
</div>

<p>Now the sort <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span> has been changed from a fairly useless overhead to a marker of “we’re not halfway yet”. In our hand-written PDA this was not a symbol on the stack but a different state.</p>

<p>When you <a href="https://github.com/Apanatshka/blog/tree/jekyll/_includes/compsci/2016/05/15/pushy-automata/binary_palindrome/src/grammar_based.rs">implement</a> this PDA you get an output that shows that there is one redundant state that it’s always in:</p>

<div class="language-rust highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">])]</span>
<span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="p">[])]</span>
<span class="n">The</span> <span class="n">input</span> <span class="n">is</span> <span class="n">accepted</span>
</code></pre></div></div>

<p>This redundant state comes from the two rules that don’t re-add the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>. These rules basically try to predict at every point in the input that this was the last input symbol of the first half, which most of the time isn’t going to be true. We could change them to instead predict that this was first input symbol of the second half, which can only happen when the second value on top of the stack is the same as this input symbol: <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mi>S</mi><mo>→</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">0, 0 S \rightarrow \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span>.<br />
This rule without the overhead is just a simple combination of the old rules <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">\varepsilon, S \rightarrow \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ε</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span> and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>0</mn><mo>→</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex">0, 0 \rightarrow \varepsilon</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8389em;vertical-align:-0.1944em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord">0</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span>. It’s only because we combined with the third rule <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>ε</mi><mo separator="true">,</mo><mi>S</mi><mo>→</mo><mn>0</mn><mi>S</mi><mn>0</mn></mrow><annotation encoding="application/x-tex">\varepsilon, S \rightarrow 0 S 0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal">ε</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.1667em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">→</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord">0</span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span><span class="mord">0</span></span></span></span> that we ended up in a sub-optimal situation.<sup id="fnref:1" role="doc-noteref"><a href="#fn:1" class="footnote" rel="footnote">1</a></sup> At this point it’s pretty clear that instead of push and popping two things of which the second is the <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex">S</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span>, can also be expressed as just another state.</p>

<p>We’re going to skip translating PDAs to CFGs, as that’s a less interesting thing to do in my opinion. It shows that PDAs aren’t more powerful than CFGs, but isn’t used for something practical as far as I know. So—at least for me—it’s enough to know that someone else has proven this property.</p>

<h2 id="ambiguity">Ambiguity</h2>

<p>The binary palindrome example has some non-determinism in there that you can’t get rid of, but in the end it still has only one way to check/derive a word in the language. When you can apply multiple rules in multiple orders and still find the same word, you get into the issue of ambiguity.</p>

<p>Now in general you can have multiple sorts while in the middle of a derivation. In that case you can always pick a different order in which to substitute the sort for one of its rules and therefore change the way you derive a word. So that’s not a very useful definition of ambiguity. To ignore this part of the order of derivation, we’ll just arbitrarily pick an order in which you should to substitute sorts in a derivation: left-to-right. This gives you a so-called leftmost derivation. If there are still multiple left-most derivations, your CFG is ambiguous.</p>

<p>Let’s look a simple ambiguous grammar:</p>

<table>
  <tbody>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi><mo>=</mo><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi><mo>+</mo><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi></mrow><annotation encoding="application/x-tex"> Expr = Expr + Expr </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Addition)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Addition)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Addition)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi><mo>=</mo><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi><mo>∗</mo><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi></mrow><annotation encoding="application/x-tex"> Expr = Expr * Expr </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2222em;"></span><span class="mbin">∗</span><span class="mspace" style="margin-right:0.2222em;"></span></span><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Multiplication)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Multiplication)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Multiplication)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex"> Expr = 0           </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">0</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Zero)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Zero)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Zero)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mi>x</mi><mi>p</mi><mi>r</mi><mo>=</mo><mn>1</mn></mrow><annotation encoding="application/x-tex"> Expr = 1           </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8778em;vertical-align:-0.1944em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">E</span><span class="mord mathnormal">x</span><span class="mord mathnormal">p</span><span class="mord mathnormal" style="margin-right:0.02778em;">r</span><span class="mspace" style="margin-right:0.2778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6444em;"></span><span class="mord">1</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(One)</mtext></mrow><annotation encoding="application/x-tex"> \text{(One)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(One)</span></span></span></span></span></td>
    </tr>
  </tbody>
</table>

<p>This is a basic arithmetic expressions grammar. And yet when you write multiple additions or multiplications, you get different possible derivation trees:</p>

<table>
  <tbody>
    <tr>
      <td>
<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: arithmetic expressions derivation tree 1 Pages: 1 -->
<svg role="img" aria-label="arithmetic expressions derivation tree 1" width="178pt" height="148pt" viewBox="0.00 0.00 178.00 148.00">
<title>arithmetic expressions derivation tree 1</title>
<desc>graph &quot;arithmetic expressions derivation tree 1&quot; { 
bgcolor=&quot;transparent&quot;;
ranksep=0.2;
nodesep=0.01;
node [shape=none, height=0.3];
node [label=Expr];
Add; Mul; Zero1; Zero2; One1;
{
  rank=&quot;same&quot;;
  Node [label=0, width=0.3];
  Z1; Z2;
  O1 [label=1];
  Plus [label=&quot;+&quot;];
  Star [label=&quot;*&quot;];
}
Add -- Zero1; Add -- Plus [weight=10]; Add -- Mul;
Zero1 -- Z1 [weight=10];
Mul -- Zero2; Mul -- Star [weight=10]; Mul -- One1;
Zero2 -- Z2 [weight=10];
One1 -- O1 [weight=10];
edge [style=invis, len=0.02];
Z1 -- Plus -- Z2 -- Star -- O1;
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 144)">
<title>arithmetic expressions derivation tree 1</title>
<!-- Add -->
<g id="node1" class="node">
<title>Add</title>
<text text-anchor="middle" x="56" y="-122.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Mul -->
<g id="node2" class="node">
<title>Mul</title>
<text text-anchor="middle" x="114" y="-84.2" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Add&#45;&#45;Mul -->
<g id="edge3" class="edge">
<title>Add&#45;&#45;Mul</title>
<path fill="none" stroke="black" d="M73.72,-115.6C80.91,-111.07 89.21,-105.85 96.39,-101.33" />
</g>
<!-- Zero1 -->
<g id="node3" class="node">
<title>Zero1</title>
<text text-anchor="middle" x="27" y="-45.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Add&#45;&#45;Zero1 -->
<g id="edge1" class="edge">
<title>Add&#45;&#45;Zero1</title>
<path fill="none" stroke="black" d="M51.72,-115.68C46.24,-101.5 36.79,-77.06 31.3,-62.86" />
</g>
<!-- Plus -->
<g id="node9" class="node">
<title>Plus</title>
<text text-anchor="middle" x="56" y="-7.2" font-family="Times,serif" font-size="14.00">+</text>
</g>
<!-- Add&#45;&#45;Plus -->
<g id="edge2" class="edge">
<title>Add&#45;&#45;Plus</title>
<path fill="none" stroke="black" d="M56,-115.87C56,-94.23 56,-46.01 56,-24.27" />
</g>
<!-- Zero2 -->
<g id="node4" class="node">
<title>Zero2</title>
<text text-anchor="middle" x="85" y="-45.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Mul&#45;&#45;Zero2 -->
<g id="edge5" class="edge">
<title>Mul&#45;&#45;Zero2</title>
<path fill="none" stroke="black" d="M105.14,-77.1C101.54,-72.57 97.4,-67.35 93.8,-62.83" />
</g>
<!-- One1 -->
<g id="node5" class="node">
<title>One1</title>
<text text-anchor="middle" x="143" y="-45.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Mul&#45;&#45;One1 -->
<g id="edge7" class="edge">
<title>Mul&#45;&#45;One1</title>
<path fill="none" stroke="black" d="M122.86,-77.1C126.46,-72.57 130.6,-67.35 134.2,-62.83" />
</g>
<!-- Star -->
<g id="node10" class="node">
<title>Star</title>
<text text-anchor="middle" x="114" y="-7.2" font-family="Times,serif" font-size="14.00">*</text>
</g>
<!-- Mul&#45;&#45;Star -->
<g id="edge6" class="edge">
<title>Mul&#45;&#45;Star</title>
<path fill="none" stroke="black" d="M114,-77.18C114,-63 114,-38.56 114,-24.36" />
</g>
<!-- Z1 -->
<g id="node6" class="node">
<title>Z1</title>
<text text-anchor="middle" x="27" y="-7.2" font-family="Times,serif" font-size="14.00">0</text>
</g>
<!-- Zero1&#45;&#45;Z1 -->
<g id="edge4" class="edge">
<title>Zero1&#45;&#45;Z1</title>
<path fill="none" stroke="black" d="M27,-38.6C27,-34.07 27,-28.85 27,-24.33" />
</g>
<!-- Z2 -->
<g id="node7" class="node">
<title>Z2</title>
<text text-anchor="middle" x="85" y="-7.2" font-family="Times,serif" font-size="14.00">0</text>
</g>
<!-- Zero2&#45;&#45;Z2 -->
<g id="edge8" class="edge">
<title>Zero2&#45;&#45;Z2</title>
<path fill="none" stroke="black" d="M85,-38.6C85,-34.07 85,-28.85 85,-24.33" />
</g>
<!-- O1 -->
<g id="node8" class="node">
<title>O1</title>
<text text-anchor="middle" x="143" y="-7.2" font-family="Times,serif" font-size="14.00">1</text>
</g>
<!-- One1&#45;&#45;O1 -->
<g id="edge9" class="edge">
<title>One1&#45;&#45;O1</title>
<path fill="none" stroke="black" d="M143,-38.6C143,-34.07 143,-28.85 143,-24.33" />
</g>
<!-- Z1&#45;&#45;Plus -->
<!-- Z2&#45;&#45;Star -->
<!-- Plus&#45;&#45;Z2 -->
<!-- Star&#45;&#45;O1 -->
</g>
</svg>
</div>
      </td>
      <td>
<div class="graphviz-wrapper">

<!-- Generated by graphviz version 10.0.1 (0)
 -->
<!-- Title: arithmetic expressions derivation tree 2 Pages: 1 -->
<svg role="img" aria-label="arithmetic expressions derivation tree 2" width="178pt" height="148pt" viewBox="0.00 0.00 178.00 148.00">
<title>arithmetic expressions derivation tree 2</title>
<desc>graph &quot;arithmetic expressions derivation tree 2&quot; { 
bgcolor=&quot;transparent&quot;;
ranksep=0.2;
nodesep=0.01;
node [shape=none, height=0.3];
node [label=Expr];
Add; Mul; Zero1; Zero2; One1;
{
  rank=&quot;same&quot;;
  Node [label=0, width=0.3];
  Z1; Z2;
  O1 [label=1];
  Plus [label=&quot;+&quot;];
  Star [label=&quot;*&quot;];
}
Add -- Zero1; Add -- Plus [weight=10]; Add -- Zero2;
Zero1 -- Z1 [weight=10];
Zero2 -- Z2 [weight=10];
Mul -- Add; Mul -- Star [weight=10]; Mul -- One1;
One1 -- O1 [weight=10];
edge [style=invis, len=0.02];
Z1 -- Plus -- Z2 -- Star -- O1;
 }</desc>

<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 144)">
<title>arithmetic expressions derivation tree 2</title>
<!-- Add -->
<g id="node1" class="node">
<title>Add</title>
<text text-anchor="middle" x="56" y="-84.2" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Zero1 -->
<g id="node3" class="node">
<title>Zero1</title>
<text text-anchor="middle" x="27" y="-45.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Add&#45;&#45;Zero1 -->
<g id="edge1" class="edge">
<title>Add&#45;&#45;Zero1</title>
<path fill="none" stroke="black" d="M47.14,-77.1C43.54,-72.57 39.4,-67.35 35.8,-62.83" />
</g>
<!-- Zero2 -->
<g id="node4" class="node">
<title>Zero2</title>
<text text-anchor="middle" x="85" y="-45.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Add&#45;&#45;Zero2 -->
<g id="edge3" class="edge">
<title>Add&#45;&#45;Zero2</title>
<path fill="none" stroke="black" d="M64.86,-77.1C68.46,-72.57 72.6,-67.35 76.2,-62.83" />
</g>
<!-- Plus -->
<g id="node9" class="node">
<title>Plus</title>
<text text-anchor="middle" x="56" y="-7.2" font-family="Times,serif" font-size="14.00">+</text>
</g>
<!-- Add&#45;&#45;Plus -->
<g id="edge2" class="edge">
<title>Add&#45;&#45;Plus</title>
<path fill="none" stroke="black" d="M56,-77.18C56,-63 56,-38.56 56,-24.36" />
</g>
<!-- Mul -->
<g id="node2" class="node">
<title>Mul</title>
<text text-anchor="middle" x="114" y="-122.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Mul&#45;&#45;Add -->
<g id="edge6" class="edge">
<title>Mul&#45;&#45;Add</title>
<path fill="none" stroke="black" d="M96.28,-115.6C89.09,-111.07 80.79,-105.85 73.61,-101.33" />
</g>
<!-- One1 -->
<g id="node5" class="node">
<title>One1</title>
<text text-anchor="middle" x="143" y="-45.7" font-family="Times,serif" font-size="14.00">Expr</text>
</g>
<!-- Mul&#45;&#45;One1 -->
<g id="edge8" class="edge">
<title>Mul&#45;&#45;One1</title>
<path fill="none" stroke="black" d="M118.28,-115.68C123.76,-101.5 133.21,-77.06 138.7,-62.86" />
</g>
<!-- Star -->
<g id="node10" class="node">
<title>Star</title>
<text text-anchor="middle" x="114" y="-7.2" font-family="Times,serif" font-size="14.00">*</text>
</g>
<!-- Mul&#45;&#45;Star -->
<g id="edge7" class="edge">
<title>Mul&#45;&#45;Star</title>
<path fill="none" stroke="black" d="M114,-115.87C114,-94.23 114,-46.01 114,-24.27" />
</g>
<!-- Z1 -->
<g id="node6" class="node">
<title>Z1</title>
<text text-anchor="middle" x="27" y="-7.2" font-family="Times,serif" font-size="14.00">0</text>
</g>
<!-- Zero1&#45;&#45;Z1 -->
<g id="edge4" class="edge">
<title>Zero1&#45;&#45;Z1</title>
<path fill="none" stroke="black" d="M27,-38.6C27,-34.07 27,-28.85 27,-24.33" />
</g>
<!-- Z2 -->
<g id="node7" class="node">
<title>Z2</title>
<text text-anchor="middle" x="85" y="-7.2" font-family="Times,serif" font-size="14.00">0</text>
</g>
<!-- Zero2&#45;&#45;Z2 -->
<g id="edge5" class="edge">
<title>Zero2&#45;&#45;Z2</title>
<path fill="none" stroke="black" d="M85,-38.6C85,-34.07 85,-28.85 85,-24.33" />
</g>
<!-- O1 -->
<g id="node8" class="node">
<title>O1</title>
<text text-anchor="middle" x="143" y="-7.2" font-family="Times,serif" font-size="14.00">1</text>
</g>
<!-- One1&#45;&#45;O1 -->
<g id="edge9" class="edge">
<title>One1&#45;&#45;O1</title>
<path fill="none" stroke="black" d="M143,-38.6C143,-34.07 143,-28.85 143,-24.33" />
</g>
<!-- Z1&#45;&#45;Plus -->
<!-- Z2&#45;&#45;Star -->
<!-- Plus&#45;&#45;Z2 -->
<!-- Star&#45;&#45;O1 -->
</g>
</svg>
</div>
      </td>
    </tr>
  </tbody>
</table>

<p>These trees show how the derivations went from sorts to terminals. In a way, they also show an ordering, where the left one does the multiplication first and the right one does the addition first. Although this is an ambiguous grammar, it doesn’t have to be. The language that it captures, arithmetic expressions, has a notion of ordering between addition and multiplication, namely that multiplication goes first. This is called precedence: multiplication takes precedence over (binds tighter than) addition. For this unambiguous language you can explicitly encode the precedence rules in the grammar to get an unambiguous grammar.</p>

<h3 id="inherently-ambiguous">Inherently ambiguous</h3>

<p>There are actually Context-Free Languages (CFLs) that are inherently ambiguous, they can only be captured by ambiguous CFGs. Here’s an example of an ambiguous grammar that captures an inherently ambiguous language:</p>

<table>
  <tbody>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex"> S    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><msub><mi>A</mi><mi>b</mi></msub><mi>C</mi></mrow><annotation encoding="application/x-tex"> = A_b C       </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Equal-A-B)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Equal-A-B)}              </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Equal-A-B)</span></span></span></span></span></td>
      <td> </td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>S</mi></mrow><annotation encoding="application/x-tex"> S    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.05764em;">S</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>A</mi><msub><mi>B</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex"> = A B_c       </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">A</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(Equal-B-C)</mtext></mrow><annotation encoding="application/x-tex"> \text{(Equal-B-C)}              </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(Equal-B-C)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex"> A_b  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>a</mi><msub><mi>A</mi><mi>b</mi></msub><mi>b</mi></mrow><annotation encoding="application/x-tex"> = a A_b b     </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">a</span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">b</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(A-B)</mtext></mrow><annotation encoding="application/x-tex"> \text{(A-B)}                    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(A-B)</span></span></span></span></span></td>
      <td> </td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex"> B_c  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>b</mi><msub><mi>B</mi><mi>c</mi></msub><mi>c</mi></mrow><annotation encoding="application/x-tex"> = b B_c c     </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.8444em;vertical-align:-0.15em;"></span><span class="mord mathnormal">b</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord mathnormal">c</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(B-C)</mtext></mrow><annotation encoding="application/x-tex"> \text{(B-C)}                    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(B-C)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>A</mi><mi>b</mi></msub></mrow><annotation encoding="application/x-tex"> A_b  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361em;"><span style="top:-2.55em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">b</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex"> = \varepsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(A-B-</mtext><mi>ε</mi><mtext>)</mtext></mrow><annotation encoding="application/x-tex"> \text{(A-B-}\varepsilon\text{)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(A-B-</span></span><span class="mord mathnormal">ε</span><span class="mord text"><span class="mord">)</span></span></span></span></span></td>
      <td> </td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>B</mi><mi>c</mi></msub></mrow><annotation encoding="application/x-tex"> B_c  </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.05017em;">B</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.1514em;"><span style="top:-2.55em;margin-left:-0.0502em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">c</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex"> = \varepsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(B-C-</mtext><mi>ε</mi><mtext>)</mtext></mrow><annotation encoding="application/x-tex"> \text{(B-C-}\varepsilon\text{)} </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(B-C-</span></span><span class="mord mathnormal">ε</span><span class="mord text"><span class="mord">)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex"> C    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>c</mi><mi>C</mi></mrow><annotation encoding="application/x-tex"> = c C         </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">c</span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(C)</mtext></mrow><annotation encoding="application/x-tex"> \text{(C)}                      </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(C)</span></span></span></span></span></td>
      <td> </td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex"> A    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>a</mi><mi>A</mi></mrow><annotation encoding="application/x-tex"> = a A         </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">a</span><span class="mord mathnormal">A</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(A)</mtext></mrow><annotation encoding="application/x-tex"> \text{(A)}                      </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(A)</span></span></span></span></span></td>
    </tr>
    <tr>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>C</mi></mrow><annotation encoding="application/x-tex"> C    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal" style="margin-right:0.07153em;">C</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex"> = \varepsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(C-</mtext><mi>ε</mi><mtext>)</mtext></mrow><annotation encoding="application/x-tex"> \text{(C-}\varepsilon\text{)}   </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(C-</span></span><span class="mord mathnormal">ε</span><span class="mord text"><span class="mord">)</span></span></span></span></span></td>
      <td> </td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>A</mi></mrow><annotation encoding="application/x-tex"> A    </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6833em;"></span><span class="mord mathnormal">A</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>=</mo><mi>ε</mi></mrow><annotation encoding="application/x-tex"> = \varepsilon </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.3669em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2778em;"></span></span><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">ε</span></span></span></span></td>
      <td><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext>(A-</mtext><mi>ε</mi><mtext>)</mtext></mrow><annotation encoding="application/x-tex"> \text{(A-}\varepsilon\text{)}   </annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord text"><span class="mord">(A-</span></span><span class="mord mathnormal">ε</span><span class="mord text"><span class="mord">)</span></span></span></span></span></td>
    </tr>
  </tbody>
</table>

<p>This describes a language that has either (1) a number of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>’s followed by an equal number of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>’s followed by an arbitrary number of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>’s, or (2) an arbitrary number of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>’s followed by a number of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>’s followed by an equal number of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>’s. These two options overlap when you have an equal number of <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>a</mi></mrow><annotation encoding="application/x-tex">a</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">a</span></span></span></span>’s, <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>b</mi></mrow><annotation encoding="application/x-tex">b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.6944em;"></span><span class="mord mathnormal">b</span></span></span></span>’s and <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>c</mi></mrow><annotation encoding="application/x-tex">c</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.4306em;"></span><span class="mord mathnormal">c</span></span></span></span>’s, which results in an inherent ambiguity in this case.</p>

<h2 id="pumping-lemma">Pumping lemma</h2>

<p>In the <a href="/compsci/2016/04/10/finite-automata/">previous blog post</a> I originally skipped the description of the pumping lemma for regular languages. But after some feedback on the post, I <a href="/compsci/2016/04/10/finite-automata/#addendum">added the description of the basic idea</a>. The idea is that any regular language (although also other languages) will have the property of a pumping length, where any word in the language larger than this length can be pumped up to a larger word that’s still in the language. For a language with a finite number of words the pumping length is larger than the largest word in the language. For infinite languages you cannot do this, which means that there are words in the language where you can find a part of the word that you’re allowed to repeat an arbitrary amount of times. This arbitrary repetition corresponds with a loop in the DFA or NFA that describes the language.</p>

<p>The pumping lemma for context-free languages is similar to that of regular languages. We have a pumping length and can split words larger than the pumping length into parts. Instead three parts of which the middle can be repeated, in CFLs we split words into five parts. The second and fourth part can be repeated an arbitrary amount of times as long as they are both repeated the same number of times. This makes sense because as we’ve seen, we can remember a bunch of things with the stack in a PDA so we can keep two parts of a word in sync with respect to repetition. From a CFG perspective it also makes sense, because the repeated parts are basically the two terminal parts that surround a recursively defined variable (for example).</p>

<p>If you want to look into this further you can look up the <a href="https://en.wikipedia.org/wiki/Pumping_lemma_for_context-free_languages">wikipedia page</a>, or another online resource I don’t know of, or a CS book on this topic. I used “Introduction to the Theory of Computation” by Michael Sipser, which goes into detail about how to write proofs with the pumping lemma (and many other interesting things).</p>

<h1 id="footnotes">Footnotes</h1>

<div class="footnotes" role="doc-endnotes">
  <ol>
    <li id="fn:1" role="doc-endnote">
      <p>Though I can’t guarantee that stuff will be optimal in general with this approach. I guess the approach is pretty vaguely defined anyway. Ehhh.. whatever ¯\_(ツ)_/¯ <a href="#fnref:1" class="reversefootnote" role="doc-backlink">&#8617;</a></p>
    </li>
  </ol>
</div>

  </article>

</div>

      </div>
    </div>

    <footer class="site-footer">

  <div class="wrapper">

    <h2 class="footer-heading">Whatever</h2>

    <div class="footer-col-wrapper">
      <div class="footer-col  footer-col-1">
        <ul class="contact-list">
          <li><a href="mailto:mail [at] this domain">mail [at] this domain</a></li>
        </ul>
      </div>

      <div class="footer-col  footer-col-2">
        <ul class="social-media-list">
          
          <li>
            <a href="https://github.com/Apanatshka">
              <span class="icon  icon--github">
                <svg viewBox="0 0 16 16">
                  <path fill="#828282" d="M7.999,0.431c-4.285,0-7.76,3.474-7.76,7.761 c0,3.428,2.223,6.337,5.307,7.363c0.388,0.071,0.53-0.168,0.53-0.374c0-0.184-0.007-0.672-0.01-1.32 c-2.159,0.469-2.614-1.04-2.614-1.04c-0.353-0.896-0.862-1.135-0.862-1.135c-0.705-0.481,0.053-0.472,0.053-0.472 c0.779,0.055,1.189,0.8,1.189,0.8c0.692,1.186,1.816,0.843,2.258,0.645c0.071-0.502,0.271-0.843,0.493-1.037 C4.86,11.425,3.049,10.76,3.049,7.786c0-0.847,0.302-1.54,0.799-2.082C3.768,5.507,3.501,4.718,3.924,3.65 c0,0,0.652-0.209,2.134,0.796C6.677,4.273,7.34,4.187,8,4.184c0.659,0.003,1.323,0.089,1.943,0.261 c1.482-1.004,2.132-0.796,2.132-0.796c0.423,1.068,0.157,1.857,0.077,2.054c0.497,0.542,0.798,1.235,0.798,2.082 c0,2.981-1.814,3.637-3.543,3.829c0.279,0.24,0.527,0.713,0.527,1.437c0,1.037-0.01,1.874-0.01,2.129 c0,0.208,0.14,0.449,0.534,0.373c3.081-1.028,5.302-3.935,5.302-7.362C15.76,3.906,12.285,0.431,7.999,0.431z"/>
                </svg>
              </span>

              <span class="username">Apanatshka</span>
            </a>
          </li>
          

          
        </ul>
      </div>

      <div class="footer-col  footer-col-3">
        <p class="text">A web log. Mostly about computer science-y stuff. 
</p>
      </div>
    </div>

  </div>

</footer>


  </body>

</html>
